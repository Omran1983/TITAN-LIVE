<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE GLASS CITADEL | Titan OS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.3.0/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Outfit', sans-serif;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.65);
            -webkit-backdrop-filter: blur(16px);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            -webkit-backdrop-filter: blur(12px);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            transition: all 0.3s ease;
        }

        .glass-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        }

        .gradient-text {
            background: linear-gradient(135deg, #2563EB 0%, #EA580C 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-active {
            background: rgba(37, 99, 235, 0.1);
            color: #2563EB;
            border-bottom: 2px solid #2563EB;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 4px;
        }
    </style>
</head>

<body
    class="bg-gradient-to-br from-blue-50 via-white to-orange-50 min-h-screen text-slate-800 selection:bg-orange-200 selection:text-orange-900">

    <!-- TOP BAR -->
    <nav class="fixed top-0 w-full z-50 glass-panel border-b border-white/40">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div
                    class="h-8 w-8 rounded-lg bg-gradient-to-br from-blue-500 to-orange-500 flex items-center justify-center shadow-lg">
                    <span class="text-white font-bold text-lg">T</span>
                </div>
                <span class="text-xl font-bold tracking-tight">TITAN <span
                        class="font-light opacity-60">OS</span></span>
            </div>

            <div class="hidden md:flex space-x-1">
                <button onclick="switchTab('dashboard')" id="nav-dashboard"
                    class="px-4 py-2 rounded-lg text-sm font-semibold transition-all nav-active">Command</button>
                <button onclick="switchTab('missions')" id="nav-missions"
                    class="px-4 py-2 rounded-lg text-sm font-semibold text-slate-500 hover:text-slate-800 transition-all">Missions</button>
                <button onclick="switchTab('leads')" id="nav-leads"
                    class="px-4 py-2 rounded-lg text-sm font-semibold text-slate-500 hover:text-slate-800 transition-all">Leads</button>
                <button onclick="switchTab('labs')" id="nav-labs"
                    class="px-4 py-2 rounded-lg text-sm font-semibold text-slate-500 hover:text-slate-800 transition-all">Innovation</button>
                <button onclick="switchTab('board')" id="nav-board"
                    class="px-4 py-2 rounded-lg text-sm font-semibold text-slate-500 hover:text-slate-800 transition-all">The
                    Board</button>
            </div>

            <div class="flex items-center space-x-4">
                <div class="flex flex-col text-right">
                    <span class="text-xs font-bold text-slate-400 uppercase tracking-wider">System Status</span>
                    <span class="text-sm font-bold text-emerald-600 flex items-center justify-end">
                        <span class="w-2 h-2 rounded-full bg-emerald-500 mr-2 animate-pulse"></span> ONLINE
                    </span>
                </div>
            </div>
        </div>
    </nav>

    <!-- CONTENT CONTAINER -->
    <main class="pt-24 pb-12 max-w-7xl mx-auto px-6">

        <!-- === DASHBOARD TAB === -->
        <div id="tab-dashboard" class="space-y-8 animate-fade-in">
            <!-- Header -->
            <div class="flex justify-between items-end">
                <div>
                    <h1 class="text-4xl font-bold gradient-text mb-2">Morning, Commander.</h1>
                    <p class="text-slate-500 text-lg">The Glass Citadel is operational. All systems nominal.</p>
                </div>
                <button onclick="refreshData()"
                    class="glass-btn px-4 py-2 rounded-lg text-sm font-semibold bg-white/50 hover:bg-white text-slate-600 shadow-sm transition">
                    Protocol Refresh
                </button>
            </div>

            <!-- Metrics Grid -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <!-- Card 1 -->
                <div class="glass-card p-6 rounded-2xl border-l-4 border-emerald-400">
                    <div class="text-slate-400 text-xs font-bold uppercase tracking-wider mb-1">Total Leads Mined</div>
                    <div class="text-3xl font-bold text-slate-800" id="stat-leads">--</div>
                    <div class="text-xs text-emerald-600 font-semibold mt-2">‚Üë Active</div>
                </div>
                <!-- Card 2 -->
                <div class="glass-card p-6 rounded-2xl border-l-4 border-blue-400">
                    <div class="text-slate-400 text-xs font-bold uppercase tracking-wider mb-1">Missions Run</div>
                    <div class="text-3xl font-bold text-slate-800" id="stat-missions">--</div>
                    <div class="text-xs text-blue-600 font-semibold mt-2">All Time</div>
                </div>
                <!-- Card 3 -->
                <div class="glass-card p-6 rounded-2xl border-l-4 border-purple-400">
                    <div class="text-slate-400 text-xs font-bold uppercase tracking-wider mb-1">Innovations Found</div>
                    <div class="text-3xl font-bold text-slate-800" id="stat-innovations">--</div>
                    <div class="text-xs text-purple-600 font-semibold mt-2">R&D Backlog</div>
                </div>
                <!-- Card 4 -->
                <div class="glass-card p-6 rounded-2xl border-l-4 border-orange-400">
                    <div class="text-slate-400 text-xs font-bold uppercase tracking-wider mb-1">Uptime Checks</div>
                    <div class="text-3xl font-bold text-slate-800" id="stat-uptime">--</div>
                    <div class="text-xs text-orange-600 font-semibold mt-2">System Health</div>
                </div>
            </div>

            <!-- Trinity Status Row -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="glass-card p-6 rounded-2xl">
                    <div class="flex items-center space-x-3 mb-4">
                        <div
                            class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold">
                            J</div>
                        <div>
                            <h3 class="font-bold text-slate-800">JARVIS</h3>
                            <div class="text-xs text-slate-500">The Architect</div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm"><span class="text-slate-500">Status</span> <span
                                class="text-emerald-600 font-semibold">Evolution Engine Active</span></div>
                        <div class="flex justify-between text-sm"><span class="text-slate-500">Focus</span> <span
                                class="text-slate-700">Strategy</span></div>
                    </div>
                </div>
                <div class="glass-card p-6 rounded-2xl">
                    <div class="flex items-center space-x-3 mb-4">
                        <div
                            class="w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center text-orange-600 font-bold">
                            T</div>
                        <div>
                            <h3 class="font-bold text-slate-800">TITAN</h3>
                            <div class="text-xs text-slate-500">The Runner</div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm"><span class="text-slate-500">Status</span> <span
                                class="text-emerald-600 font-semibold">Standing By</span></div>
                        <div class="flex justify-between text-sm"><span class="text-slate-500">Last Run</span> <span
                                class="text-slate-700" id="last-run-time">--</span></div>
                    </div>
                </div>
                <div class="glass-card p-6 rounded-2xl">
                    <div class="flex items-center space-x-3 mb-4">
                        <div
                            class="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 font-bold">
                            A</div>
                        <div>
                            <h3 class="font-bold text-slate-800">AION-ZERO</h3>
                            <div class="text-xs text-slate-500">The Memory</div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm"><span class="text-slate-500">DB Status</span> <span
                                class="text-emerald-600 font-semibold">Connected</span></div>
                        <div class="flex justify-between text-sm"><span class="text-slate-500">Storage</span> <span
                                class="text-slate-700">Healthy</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- === MISSIONS TAB === -->
        <div id="tab-missions" class="space-y-8 hidden">
            <div class="flex justify-between items-end">
                <h1 class="text-3xl font-bold text-slate-800">Mission Control</h1>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Launch Pad -->
                <div class="lg:col-span-1 space-y-4">
                    <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider">Launch Pad</h3>

                    <button onclick="launchMission(1)"
                        class="w-full glass-card p-4 rounded-xl text-left hover:border-blue-400 group">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-bold text-slate-700 group-hover:text-blue-600">Mission 1: Lead Hunt</span>
                            <span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded">REVENUE</span>
                        </div>
                        <p class="text-xs text-slate-500">Mines target emails from web. Goal: 5 Leads.</p>
                    </button>

                    <button onclick="launchMission(2)"
                        class="w-full glass-card p-4 rounded-xl text-left hover:border-orange-400 group">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-bold text-slate-700 group-hover:text-orange-600">Mission 2: Safety
                                Check</span>
                            <span class="text-xs bg-orange-100 text-orange-600 px-2 py-1 rounded">DEFENSE</span>
                        </div>
                        <p class="text-xs text-slate-500">Verifies system uptime. Goal: 1 Check.</p>
                    </button>

                    <button onclick="launchMission(3)"
                        class="w-full glass-card p-4 rounded-xl text-left hover:border-purple-400 group">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-bold text-slate-700 group-hover:text-purple-600">Mission 3: Innovation
                                Hunt</span>
                            <span class="text-xs bg-purple-100 text-purple-600 px-2 py-1 rounded">R&D</span>
                        </div>
                        <p class="text-xs text-slate-500">Scouts new AI tech on Github. Goal: 5 Findings.</p>
                    </button>

                    <div id="launch-feedback"
                        class="hidden p-3 rounded-lg bg-emerald-100 text-emerald-800 text-sm font-semibold">
                        <!-- JS injects message -->
                    </div>
                </div>

                <!-- Mission Log (The Scar Tissue) -->
                <div class="lg:col-span-2">
                    <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4">Mission History (Scar
                        Tissue)</h3>
                    <div class="glass-panel rounded-2xl overflow-hidden">
                        <table class="w-full text-sm text-left">
                            <thead class="bg-white/50 text-slate-500 border-b border-white/40">
                                <tr>
                                    <th class="px-6 py-3 font-semibold">Mission</th>
                                    <th class="px-6 py-3 font-semibold">Status</th>
                                    <th class="px-6 py-3 font-semibold">Result</th>
                                    <th class="px-6 py-3 font-semibold text-right">Time ago</th>
                                </tr>
                            </thead>
                            <tbody id="mission-table-body" class="divide-y divide-white/40">
                                <!-- JS Injects Rows -->
                                <tr>
                                    <td colspan="4" class="px-6 py-8 text-center text-slate-400">Loading history...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- === LEADS TAB === -->
        <div id="tab-leads" class="space-y-8 hidden">
            <div class="flex justify-between items-end">
                <h1 class="text-3xl font-bold text-slate-800">Leads Vault <span
                        class="text-emerald-500 text-lg ml-2">(Revenue)</span></h1>
                <span class="text-slate-400 text-sm">Valid Emails Mined by Titan</span>
            </div>

            <div class="glass-panel rounded-2xl overflow-hidden">
                <table class="w-full text-sm text-left">
                    <thead class="bg-white/50 text-slate-500 border-b border-white/40">
                        <tr>
                            <th class="px-6 py-3 font-semibold">Target Name</th>
                            <th class="px-6 py-3 font-semibold">Email Found</th>
                            <th class="px-6 py-3 font-semibold">Source URL</th>
                        </tr>
                    </thead>
                    <tbody id="leads-table-body" class="divide-y divide-white/40">
                        <tr>
                            <td colspan="3" class="px-6 py-8 text-center text-slate-400">Opening Vault...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- === LABS TAB === -->
        <div id="tab-labs" class="space-y-8 hidden">
            <div class="flex justify-between items-end">
                <div>
                    <h1 class="text-3xl font-bold text-slate-800">Innovation Lab <span
                            class="text-purple-500 text-lg ml-2">(R&D)</span></h1>
                    <p class="text-slate-500 mt-2">How TITAN is adapting new discoveries.</p>
                </div>
            </div>

            <!-- Growth/Analysis Context -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8" id="growth-grid">
                <!-- JS Injects Growth Cards -->
            </div>

            <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4">Recent Scout Findings</h3>
            <div id="innovations-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- JS Injects Innovation Cards -->
                <div class="col-span-full text-center text-slate-400 py-12">Scouting for ideas...</div>
            </div>
        </div>

        <!-- === BOARD TAB === -->
        <div id="tab-board" class="space-y-8 hidden">
            <h1 class="text-3xl font-bold text-slate-800">The Board of Directors</h1>
            <div class="glass-panel p-8 rounded-3xl h-[600px] flex items-center justify-center bg-white/40">
                <div class="mermaid">
                    graph TD
                    USER((YOU<br>The Chairman)) --> GOV[THE GOVERNOR<br>Authority Layer]

                    subgraph TRINITY [The Trinity System]
                    direction TB
                    GOV --> JARVIS[JARVIS<br>The Brain]
                    GOV --> TITAN[TITAN<br>The Body]
                    GOV --> AZ[AION-ZERO<br>The Memory]
                    end

                    subgraph AGENTS [Active Agents]
                    JARVIS --> EVO[Evolution Engine<br>Planner]
                    TITAN --> MINER[Miner<br>Revenue]
                    TITAN --> MONITOR[Monitor<br>Safety]
                    TITAN --> SCOUT[Scout<br>Innovation]
                    AZ --> VAULT[Database<br>Storage]
                    end

                    style USER fill:#fff,stroke:#333,stroke-width:4px
                    style GOV fill:#000,stroke:#333,color:#fff
                    style JARVIS fill:#dbeafe,stroke:#2563EB
                    style TITAN fill:#ffedd5,stroke:#ea580c
                    style AZ fill:#f3e8ff,stroke:#9333ea
                </div>
            </div>

            <!-- ADDED: Agent Table -->
            <div class="glass-panel rounded-2xl overflow-hidden mt-8">
                <table class="w-full text-sm text-left">
                    <thead class="bg-white/50 text-slate-500 border-b border-white/40">
                        <tr>
                            <th class="px-6 py-3 font-semibold">PID</th>
                            <th class="px-6 py-3 font-semibold">Agent Name</th>
                            <th class="px-6 py-3 font-semibold">Status</th>
                            <th class="px-6 py-3 font-semibold">CPU</th>
                            <th class="px-6 py-3 font-semibold text-right">Started</th>
                        </tr>
                    </thead>
                    <tbody id="agents-table-body" class="divide-y divide-white/40">
                        <tr>
                            <td colspan="5" class="px-6 text-center py-4 text-slate-400">Loading Agents...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        </div>

    </main>

    <script>
        // --- TABS LOGIC ---
        function switchTab(tabId) {
            // Hide all tabs
            ['dashboard', 'missions', 'leads', 'labs', 'board'].forEach(id => {
                document.getElementById('tab-' + id).classList.add('hidden');
                document.getElementById('nav-' + id).classList.remove('nav-active', 'text-slate-800');
                document.getElementById('nav-' + id).classList.add('text-slate-500');
            });

            // Show selected
            document.getElementById('tab-' + tabId).classList.remove('hidden');
            document.getElementById('nav-' + tabId).classList.add('nav-active');
            document.getElementById('nav-' + tabId).classList.remove('text-slate-500');

            // Trigger specific refreshes
            if (tabId === 'missions') loadMissions();
            if (tabId === 'leads') loadLeads();
            if (tabId === 'labs') {
                loadInnovations();
                loadGrowth();
            }
            if (tabId === 'board') {
                mermaid.init();
                loadAgents();
                // Persist auto-refresh for agents only when on board? 
                // Creating a simplified global interval for agents just in case.
            }
        }

        async function loadAgents() {
            try {
                const res = await fetch('/api/agents');
                const data = await res.json();
                const tbody = document.getElementById('agents-table-body');
                tbody.innerHTML = '';

                if (!data.agents || data.agents.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" class="px-6 py-8 text-center text-slate-400">No active Titan agents found.</td></tr>';
                    return;
                }

                data.agents.forEach(a => {
                    const tr = document.createElement('tr');
                    tr.className = "hover:bg-white/40 transition";

                    let statusColor = 'text-slate-600';
                    if (a.status === 'running') statusColor = 'text-emerald-600 font-bold';

                    tr.innerHTML = `
                        <td class="px-6 py-4 font-mono text-xs text-slate-400">#${a.pid}</td>
                        <td class="px-6 py-4 font-bold text-slate-800">${a.name}</td>
                        <td class="px-6 py-4 ${statusColor} uppercase text-xs tracking-wider">${a.status}</td>
                        <td class="px-6 py-4 text-slate-600">${a.cpu_percent}%</td>
                        <td class="px-6 py-4 text-right text-slate-400 text-xs">${new Date(a.started_at * 1000).toLocaleTimeString()}</td>
                     `;
                    tbody.appendChild(tr);
                });

            } catch (e) { console.error("Agents fail", e); }
        }

        // --- API CALLS ---

        async function refreshData() {
            try {
                const res = await fetch('/api/status');
                const data = await res.json();

                document.getElementById('stat-missions').textContent = data.stats.missions_run;
                document.getElementById('stat-innovations').textContent = data.stats.innovations;
                document.getElementById('stat-uptime').textContent = data.stats.uptime_checks;
                document.getElementById('stat-leads').textContent = data.stats.leads;

            } catch (e) { console.error("Stats fail", e); }
        }

        async function loadMissions() {
            try {
                const res = await fetch('/api/missions');
                const rows = await res.json();
                const tbody = document.getElementById('mission-table-body');
                tbody.innerHTML = '';

                rows.forEach(r => {
                    const tr = document.createElement('tr');
                    tr.className = "hover:bg-white/40 transition";
                    const gained = r.gained_val !== null ? `+${r.gained_val}` : '--';

                    let statusColor = 'text-slate-500';
                    if (r.status === 'success') statusColor = 'text-emerald-600 font-bold';
                    if (r.status === 'failed') statusColor = 'text-red-600 font-bold';

                    tr.innerHTML = `
                        <td class="px-6 py-4 font-medium text-slate-800">${r.mission_name}</td>
                        <td class="px-6 py-4 ${statusColor}">${r.status.toUpperCase()}</td>
                        <td class="px-6 py-4 text-slate-600">${gained} Units</td>
                        <td class="px-6 py-4 text-right text-slate-400 text-xs">${new Date(r.start_ts).toLocaleString()}</td>
                    `;
                    tbody.appendChild(tr);
                });

                // Update Last Run Time on Dash
                if (rows.length > 0) {
                    document.getElementById('last-run-time').textContent = new Date(rows[0].start_ts).toLocaleTimeString();
                }

            } catch (e) { console.error("History fail", e); }
        }

        async function launchMission(id) {
            const feedback = document.getElementById('launch-feedback');
            feedback.textContent = "üöÄ Initiating Launch Sequence...";
            feedback.classList.remove('hidden');

            try {
                const res = await fetch('/api/mission/start', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id: id })
                });
                const data = await res.json();

                if (data.status === 'launched') {
                    feedback.textContent = `‚úÖ Mission ${id} Launched by Governor.`;
                    setTimeout(() => loadMissions(), 2000); // Reload table
                } else {
                    feedback.textContent = `‚ùå Launch Failed: ${data.error}`;
                    feedback.className = "p-3 rounded-lg bg-red-100 text-red-800 text-sm font-semibold";
                }
            } catch (e) {
                feedback.textContent = `‚ùå Network Error`;
            }
        }

        async function loadLeads() {
            try {
                const res = await fetch('/api/leads');
                const rows = await res.json();
                const tbody = document.getElementById('leads-table-body');
                tbody.innerHTML = '';

                if (rows.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="3" class="px-6 py-8 text-center text-slate-400">Vault Empty. Run Mission 1.</td></tr>';
                    return;
                }

                rows.forEach(r => {
                    const tr = document.createElement('tr');
                    tr.className = "hover:bg-white/40 transition";
                    const email = r.contact_email ? `<span class="bg-emerald-100 text-emerald-700 font-bold px-2 py-1 rounded text-xs select-all">${r.contact_email}</span>` : '<span class="text-slate-300">--</span>';

                    tr.innerHTML = `
                        <td class="px-6 py-4 font-medium text-slate-800">${r.name.substring(0, 40)}</td>
                        <td class="px-6 py-4">${email}</td>
                        <td class="px-6 py-4"><a href="${r.url}" target="_blank" class="text-blue-400 hover:text-blue-600">Link ‚Üó</a></td>
                    `;
                    tbody.appendChild(tr);
                });
            } catch (e) { console.error("Leads fail", e); }
        }

        async function loadGrowth() {
            try {
                const res = await fetch('/api/growth');
                const items = await res.json();
                const grid = document.getElementById('growth-grid');
                grid.innerHTML = '';

                items.forEach(i => {
                    const el = document.createElement('div');
                    el.className = "glass-card p-4 rounded-xl border border-white/50";
                    el.innerHTML = `
                         <div class="flex justify-between text-xs font-bold uppercase tracking-wider mb-2">
                            <span class="text-slate-400">${i.area}</span>
                            <span class="text-blue-600">${i.status}</span>
                         </div>
                         <p class="text-slate-700 font-medium text-sm leading-snug">"${i.insight}"</p>
                    `;
                    grid.appendChild(el);
                });
            } catch (e) { console.error("Growth fail", e); }
        }

        async function loadInnovations() {
            try {
                const res = await fetch('/api/innovations');
                const items = await res.json();
                const grid = document.getElementById('innovations-grid');
                grid.innerHTML = '';

                items.forEach(i => {
                    const card = document.createElement('div');
                    card.className = "glass-card p-5 rounded-xl flex flex-col justify-between h-48";
                    card.innerHTML = `
                        <div>
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-xs font-bold text-purple-500 bg-purple-50 px-2 py-1 rounded border border-purple-100">${i.category}</span>
                            </div>
                            <h3 class="font-bold text-slate-800 leading-tight mb-2 line-clamp-2">${i.title}</h3>
                            <p class="text-xs text-slate-500 line-clamp-3">${i.description}</p>
                        </div>
                        <a href="${i.url}" target="_blank" class="text-xs font-bold text-blue-600 hover:text-blue-800 mt-4 flex items-center">
                            VIEW SOURCE ‚Üí
                        </a>
                    `;
                    grid.appendChild(card);
                });
            } catch (e) { console.error("Innovations fail", e); }
        }

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            refreshData();
            loadMissions();
            mermaid.initialize({ startOnLoad: true, theme: 'base' });

            // Auto Refresh Loop
            setInterval(refreshData, 5000);
        });

    </script>
</body>

</html>